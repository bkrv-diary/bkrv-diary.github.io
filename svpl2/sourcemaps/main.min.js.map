{"version":3,"sources":["main.js"],"names":["setCookie","name","value","options","path","domain","document","location","hostname","expires","Date","toUTCString","updatedCookie","encodeURIComponent","optionKey","optionValue","cookie","initCountdown","countDownDate","setMinutes","getMinutes","x","setInterval","now","distance","getTime","minutes","Math","floor","seconds","querySelector","innerHTML","clearInterval","initNavigationLinks","querySelectorAll","forEach","link","addEventListener","e","preventDefault","id","getAttribute","substr","getElementById","scrollIntoView","behavior","block","initBurgerMenu","btn","list","header","links","classList","toggle","body","initPopup","popup","anc","contains","add","cl","remove","fields","el","isValid","phone","email","emailPattern","inps","inp","length","test","errors","Object","keys","key","console","log","formData","FormData","append","async","response","fetch","protocol","method","headers","ok","result","json","clientId","fileds","clientHash","fbq","setTimeout","assign","host","sendForm","book","window"],"mappings":"AACA,SAASA,UAAUC,EAAMC,EAAOC,EAAU,CAAC,IACvCA,EAAU,CACNC,KAAM,IACNC,OAAQ,IAAIC,SAASC,SAASC,cAC3BL,IAEKM,mBAAmBC,OAC3BP,EAAQM,QAAUN,EAAQM,QAAQE,eAEtC,IAAIC,EAAgBC,mBAAmBZ,GAAQ,IAAMY,mBAAmBX,GACxE,IAAK,IAAIY,KAAaX,EAAS,CAC3BS,GAAiB,KAAOE,EACxB,IAAIC,EAAcZ,EAAQW,IACN,IAAhBC,IACAH,GAAiB,IAAMG,EAE/B,CACAT,SAASU,OAASJ,CACtB,CAEA,MAAMK,cAAgB,KAElB,IAAIC,EAAgB,IAAIR,KACxBQ,EAAcC,WAAWD,EAAcE,aAAe,IAEtD,MAAMC,EAAIC,aAAY,KAClB,IAAIC,EAAM,IAAIb,KACVc,EAAWN,EAAcO,UAAYF,EAAIE,UAEzCC,EAAUC,KAAKC,MAAOJ,EAAW,KAAoB,KACrDK,EAAUF,KAAKC,MAAOJ,EAAW,IAAe,KAEpDlB,SAASwB,cAAc,0BAA0BC,UAAY,MAAML,EAAU,GAAK,IAAMA,EAAUA,KAAWG,EAAU,GAAK,IAAMA,EAAUA,QACxIL,EAAW,IACXQ,cAAcX,GACdf,SAASwB,cAAc,0BAA0BC,UAAY,eACjE,GACD,IAAI,EAGLE,oBAAsB,KACV3B,SAAS4B,iBAAiB,4CAElCC,SAASC,IACXA,EAAKC,iBAAiB,SAAUC,IAC5BA,EAAEC,iBACF,IAAIC,EAAKJ,EAAKK,aAAa,QAAQC,OAAO,GAEtCF,GACAlC,SAASqC,eAAeH,GAAII,eAAe,CACvCC,SAAU,SACVC,MAAO,SAEf,GACH,GACJ,EAGCC,eAAiB,KACnB,MAAMC,EAAM1C,SAASwB,cAAc,mBAC7BmB,EAAO3C,SAASwB,cAAc,gBAC9BoB,EAAS5C,SAASwB,cAAc,WAChCqB,EAAQ7C,SAAS4B,iBAAiB,oDAExCc,EAAIX,iBAAiB,SAAS,KAC1BW,EAAII,UAAUC,OAAO,UACrBJ,EAAKG,UAAUC,OAAO,UACtBH,EAAOE,UAAUC,OAAO,UACxB/C,SAASgD,KAAKF,UAAUC,OAAO,gBAAe,IAGlDF,EAAMhB,SAAQC,IACVA,EAAKC,iBAAiB,SAAS,KAC3BW,EAAII,UAAUC,OAAO,UACrBJ,EAAKG,UAAUC,OAAO,UACtBH,EAAOE,UAAUC,OAAO,UACxB/C,SAASgD,KAAKF,UAAUC,OAAO,gBAAe,GACjD,GACJ,EAGCE,UAAY,KACd,MAAMC,EAAQlD,SAASwB,cAAc,iBACrBxB,SAAS4B,iBAAiB,8BAElCC,SAAQsB,IACZA,EAAIpB,iBAAiB,SAAS,KACrBmB,EAAMJ,UAAUM,SAAS,WAC1BF,EAAMJ,UAAUO,IAAI,SACxB,GACH,IAGSrD,SAAS4B,iBAAiB,+BAElCC,SAAQyB,IACVA,EAAGvB,iBAAiB,SAAS,KACrBmB,EAAMJ,UAAUM,SAAS,WACzBF,EAAMJ,UAAUS,OAAO,SAC3B,GACH,IAGL,MAAMC,EAAS,CACX7D,KAAM,CACF8D,GAAIP,EAAM1B,cAAc,0BACxBkC,SAAS,GAEbC,MAAO,CACHF,GAAIP,EAAM1B,cAAc,2BACxBkC,SAAS,GAEbE,MAAO,CACHH,GAAIP,EAAM1B,cAAc,2BACxBkC,SAAS,IAIXG,EAAe,64BAErBC,KAAKjC,SAAQkC,IACTA,EAAIhC,iBAAiB,SAAS,KAW1B,OAVAgC,EAAIjB,UAAUS,OAAO,WAEJ,IAAbQ,EAAInE,MACJmE,EAAIjB,UAAUO,IAAI,YAElBU,EAAIjB,UAAUS,OAAO,YAGdQ,EAAI5B,aAAa,SAGxB,IAAK,aACG4B,EAAInE,MAAMoE,OAAS,GACnBR,EAAO7D,KAAK+D,SAAU,EACtBK,EAAIjB,UAAUO,IAAI,aAElBG,EAAO7D,KAAK+D,SAAU,EACtBK,EAAIjB,UAAUS,OAAO,YAEzB,MACJ,IAAK,cACIM,EAAaI,KAAKF,EAAInE,QAIvB4D,EAAOI,MAAMF,SAAU,EACvBK,EAAIjB,UAAUS,OAAO,aAJrBC,EAAOI,MAAMF,SAAU,EACvBK,EAAIjB,UAAUO,IAAI,YAKtB,MAEJ,IAAK,cACGU,EAAInE,MAAMoE,OAAS,IACnBR,EAAOG,MAAMD,SAAU,EACvBK,EAAIjB,UAAUO,IAAI,aAElBG,EAAOG,MAAMD,SAAU,EACvBK,EAAIjB,UAAUS,OAAO,YAGjC,GACH,IAoEWL,EAAM1B,cAAc,CAAC,6BAC7BO,iBAAiB,SAAS,KAjErB,MACT,IAAImC,EAAS,EAOb,GANAC,OAAOC,KAAKZ,GAAQ3B,SAAQwC,IACnBb,EAAOa,GAAKX,SACbQ,GACJ,IAGU,GAAVA,EAAa,CACbI,QAAQC,IAAI,gBAEZ,IAAIC,EAAW,IAAIC,SACnBD,EAASE,OAAO,MAAOlB,EAAO7D,KAAK8D,GAAG7D,OACtC4E,EAASE,OAAO,QAASlB,EAAOI,MAAMH,GAAG7D,OACzC4E,EAASE,OAAO,WAAYlB,EAAOG,MAAMF,GAAG7D,OAC5C4E,EAASE,OAAO,eAAgB,YAChCF,EAASE,OAAO,OAAQ,IACxBF,EAASE,OAAO,YAAa,IAEdC,WACXL,QAAQC,IAAI,oBAEZ,IAAIK,QAAiBC,MAAM,GAAG7E,SAASC,SAAS6E,aAAa9E,SAASC,SAASC,wBAAyB,CACpG6E,OAAQ,OACRC,QAAS,CACL,mBAAoB,kBAExBhC,KAAMwB,IAGV,GAAII,EAASK,GAAI,CAEb,IAAIC,QAAeN,EAASO,OAE5BzF,UAAU,WAAYwF,EAAOE,SAAU,CAAE,UAAW,SACpD1F,UAAU,cAAe8D,EAAOI,MAAMH,GAAG7D,MAAO,CAAE,UAAW,SAC7DF,UAAU,aAAc2F,OAAO1F,KAAK8D,GAAG7D,MAAO,CAAE,UAAW,SAC3DF,UAAU,aAAcwF,EAAOI,WAAY,CAAE,UAAW,SAGxD5F,UAAU,iBAAkB,cAAe,CAAE,UAAW,SACxDA,UAAU,oBAAqB,0DAA2D,CAAE,UAAW,SAGvGoE,KAAKjC,SAAQkC,IACTA,EAAInE,MAAQ,MAGG,mBAAR2F,KAAsBA,IAAI,QAAS,wBAE9CjB,QAAQC,IAAI,yBAEZiB,YAAW,KACPxF,SAASC,SAASwF,OAAO,GAAGzF,SAASC,SAAS6E,aAAa9E,SAASC,SAASyF,cAAa,GAC3F,IACP,MACIpB,QAAQC,IAAI,uBAChB,EAGJoB,EACJ,GAKAC,EAAK,GACR,EAILC,OAAO9D,iBAAiB,oBAAoB,KAExCpB,gBAtMcX,SAAS4B,iBAAiB,4CAElCC,SAASC,IACXA,EAAKC,iBAAiB,SAAUC,IAC5BA,EAAEC,iBACF,IAAIC,EAAKJ,EAAKK,aAAa,QAAQC,OAAO,GAEtCF,GACAlC,SAASqC,eAAeH,GAAII,eAAe,CACvCC,SAAU,SACVC,MAAO,SAEf,GACH,IA2LLC,iBACAQ,WAAU","file":"../js/main.min.js","sourcesContent":["// cookie function\nfunction setCookie(name, value, options = {}) {\n    options = {\n        path: '/',\n        domain: `.${document.location.hostname}`,\n        ...options\n    }\n    if (options.expires instanceof Date) {\n        options.expires = options.expires.toUTCString();\n    }\n    let updatedCookie = encodeURIComponent(name) + \"=\" + encodeURIComponent(value)\n    for (let optionKey in options) {\n        updatedCookie += \"; \" + optionKey;\n        let optionValue = options[optionKey];\n        if (optionValue !== true) {\n            updatedCookie += \"=\" + optionValue;\n        }\n    }\n    document.cookie = updatedCookie\n}\n\nconst initCountdown = () => {\n\n    let countDownDate = new Date()\n    countDownDate.setMinutes(countDownDate.getMinutes() + 40)\n\n    const x = setInterval(() => {\n        let now = new Date();\n        let distance = countDownDate.getTime() - now.getTime();\n\n        let minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));\n        let seconds = Math.floor((distance % (1000 * 60)) / 1000);\n\n        document.querySelector('[data-countdown=\"out\"]').innerHTML = `00:${minutes < 10 ? '0' + minutes : minutes}:${seconds < 10 ? '0' + seconds : seconds} сек`\n        if (distance < 0) {\n            clearInterval(x)\n            document.querySelector('[data-countdown=\"out\"]').innerHTML = '00:00:00 сек'\n        }\n    }, 1000)\n}\n\nconst initNavigationLinks = () => {\n    const links = document.querySelectorAll('a[href*=\"#\"][data-action=\"smoothscroll\"]')\n\n    links.forEach((link) => {\n        link.addEventListener('click', (e) => {\n            e.preventDefault()\n            let id = link.getAttribute('href').substr(1)\n\n            if (id) {\n                document.getElementById(id).scrollIntoView({\n                    behavior: 'smooth',\n                    block: 'start'\n                })\n            }\n        })\n    })\n}\n\nconst initBurgerMenu = () => {\n    const btn = document.querySelector('.header__burger')\n    const list = document.querySelector('.header__nav')\n    const header = document.querySelector('.header')\n    const links = document.querySelectorAll('.header a[href*=\"#\"][data-action=\"smoothscroll\"]')\n\n    btn.addEventListener('click', () => {\n        btn.classList.toggle('active')\n        list.classList.toggle('active')\n        header.classList.toggle('active')\n        document.body.classList.toggle('burger-active')\n    })\n\n    links.forEach(link => {\n        link.addEventListener('click', () => {\n            btn.classList.toggle('active')\n            list.classList.toggle('active')\n            header.classList.toggle('active')\n            document.body.classList.toggle('burger-active')\n        })\n    })\n}\n\nconst initPopup = () => {\n    const popup = document.querySelector('.l-how__popup')\n    const anchors = document.querySelectorAll('[data-popup-action=\"open\"]')\n\n    anchors.forEach(anc => {\n        anc.addEventListener('click', () => {\n            if (!popup.classList.contains('--show')) {\n                popup.classList.add('--show')\n            }\n        })\n    })\n\n    const close = document.querySelectorAll('[data-popup-action=\"close\"]')\n\n    close.forEach(cl => {\n        cl.addEventListener('click', () => {\n            if (popup.classList.contains('--show')) {\n                popup.classList.remove('--show')\n            }\n        })\n    })\n\n    const fields = {\n        name: {\n            el: popup.querySelector('input[name=input_name]'),\n            isValid: false,\n        },\n        phone: {\n            el: popup.querySelector('input[name=input_phone]'),\n            isValid: false,\n        },\n        email: {\n            el: popup.querySelector('input[name=input_email]'),\n            isValid: false,\n        }\n    }\n\n    const emailPattern = /^((([a-z]|\\d|[!#\\$%&'\\*\\+\\-\\/=\\?\\^_`{\\|}~]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])+(\\.([a-z]|\\d|[!#\\$%&'\\*\\+\\-\\/=\\?\\^_`{\\|}~]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])+)*)|((\\x22)((((\\x20|\\x09)*(\\x0d\\x0a))?(\\x20|\\x09)+)?(([\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x7f]|\\x21|[\\x23-\\x5b]|[\\x5d-\\x7e]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(\\\\([\\x01-\\x09\\x0b\\x0c\\x0d-\\x7f]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]))))*(((\\x20|\\x09)*(\\x0d\\x0a))?(\\x20|\\x09)+)?(\\x22)))@((([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))\\.)+(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))\\.?$/i;\n\n    inps.forEach(inp => {\n        inp.addEventListener('keyup', () => {\n            inp.classList.remove('--error')\n\n            if (inp.value != '') {\n                inp.classList.add('--filled');\n            } else {\n                inp.classList.remove('--filled');\n            }\n\n            let type = inp.getAttribute('name')\n\n            switch (type) {\n                case \"input_name\":\n                    if (inp.value.length < 3) {\n                        fields.name.isValid = false\n                        inp.classList.add('--error')\n                    } else {\n                        fields.name.isValid = true\n                        inp.classList.remove('--error')\n                    }\n                    break;\n                case \"input_email\":\n                    if (!emailPattern.test(inp.value)) {\n                        fields.email.isValid = false\n                        inp.classList.add('--error')\n                    } else {\n                        fields.email.isValid = true\n                        inp.classList.remove('--error')\n                    }\n                    break;\n\n                case \"input_phone\":\n                    if (inp.value.length < 10) {\n                        fields.phone.isValid = false\n                        inp.classList.add('--error')\n                    } else {\n                        fields.phone.isValid = true\n                        inp.classList.remove('--error')\n                    }\n                    break;\n            }\n        })\n    })\n\n\n    const book = () => {\n        let errors = 0;\n        Object.keys(fields).forEach(key => {\n            if (!fields[key].isValid) {\n                errors++\n            }\n        })\n\n        if (errors == 0) {\n            console.log('submit event')\n\n            let formData = new FormData()\n            formData.append('FIO', fields.name.el.value)\n            formData.append('email', fields.email.el.value)\n            formData.append('telephon', fields.phone.el.value)\n            formData.append('landing_page', 'laziness')\n            formData.append('city', '')\n            formData.append('is_mobile', '')\n\n            let sendForm = async () => {\n                console.log('trying to submit')\n\n                let response = await fetch(`${document.location.protocol}//${document.location.hostname}/register.php`, {\n                    method: 'POST',\n                    headers: {\n                        \"X-Requested-With\": \"XMLHttpRequest\",\n                    },\n                    body: formData\n                });\n\n                if (response.ok) {\n\n                    let result = await response.json()\n\n                    setCookie('clientId', result.clientId, { 'max-age': 525600 })\n                    setCookie('clientEmail', fields.email.el.value, { 'max-age': 525600 })\n                    setCookie('clientName', fileds.name.el.value, { 'max-age': 525600 })\n                    setCookie('clientHash', result.clientHash, { 'max-age': 525600 })\n\n                    // set video for thanks page\n                    setCookie('landingVideoId', 'iWg7gtGHlbo', { 'max-age': 525600 })\n                    setCookie('landingVideoTitle', 'Соблазн комфорта. На поводу у лени. Психология человека', { 'max-age': 525600 })\n\n                    // reset fiedls\n                    inps.forEach(inp => {\n                        inp.value = ''\n                    })\n\n                    if (typeof fbq === \"function\") { fbq('track', 'CompleteRegistration'); }\n\n                    console.log('submitted sucessfully')\n\n                    setTimeout(() => {\n                        document.location.assign(`${document.location.protocol}//${document.location.host}/thanks`)\n                    }, 500)\n                } else {\n                    console.log('server request error')\n                }\n            }\n\n            sendForm()\n        }\n    }\n\n    const bookBtn = popup.querySelector(['[data-popup-action=book]'])\n    bookBtn.addEventListener('click', () => {\n        book()\n    })\n}\n\n\nwindow.addEventListener('DOMContentLoaded', () => {\n\n    initCountdown()\n    initNavigationLinks()\n    initBurgerMenu()\n    initPopup()\n\n})"]}